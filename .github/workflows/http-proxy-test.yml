name: http proxy test
on: 
    workflow_dispatch:

permissions:
    contents: read

jobs:
    proxy-test:
        runs-on: ubuntu-latest
        steps:
          - name: clone repo
            uses: actions/checkout@v4
          - name: install tinyproxy
            run: |
              sudo apt-get update
              sudo apt-get install tinyproxy
          - name: start tinyproxy
            run: sudo tinyproxy -c tinyproxy.conf
          - name: hit da proxy
            run: http_proxy=127.0.0.1:9999 curl example.com
          - name: look at whatever.txt
            run: sudo cat whatever.txt
          - name: hit da proxy again
            run: http_proxy=127.0.0.1:9999 curl google.com
          - name: checkout logs again
            run: sudo cat whatever.txt